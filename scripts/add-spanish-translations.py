#!/usr/bin/env python3
"""Add Spanish translations to the .po file"""

import re
import sys

# Spanish translations for admin UI
translations = {
    "Minimum passphrase length should be at least 8 characters": "La longitud mínima de la contraseña debe ser de al menos 8 caracteres",
    "Maximum passphrase length should not exceed 128 characters": "La longitud máxima de la contraseña no debe exceder los 128 caracteres",
    "TTL should be at least 60 seconds": "El TTL debe ser de al menos 60 segundos",
    "TTL should not exceed 3600 seconds (1 hour)": "El TTL no debe exceder los 3600 segundos (1 hora)",
    "Max tokens should be at least 16": "Los tokens máximos deben ser al menos 16",
    "Max tokens should not exceed 1024": "Los tokens máximos no deben exceder 1024",
    "File size cannot be negative (use 0 for unlimited)": "El tamaño del archivo no puede ser negativo (use 0 para ilimitado)",
    "File size limit should not exceed 10240 MB (10 GB)": "El límite de tamaño de archivo no debe exceder 10240 MB (10 GB)",
    "Timeout should be at least 5 seconds": "El tiempo de espera debe ser de al menos 5 segundos",
    "Timeout should not exceed 300 seconds": "El tiempo de espera no debe exceder los 300 segundos",
    "Close": "Cerrar",
    "USB Enforcer Administration": "Administración de USB Enforcer",
    "USB Enforcer Configuration": "Configuración de USB Enforcer",
    "Save Configuration": "Guardar Configuración",
    "Restart Daemon": "Reiniciar Demonio",
    "Restart usb-enforcerd to reload configuration": "Reiniciar usb-enforcerd para recargar la configuración",
    "Documentation": "Documentación",
    "Administration Guide": "Guía de Administración",
    "Content Scanning": "Escaneo de Contenido",
    "Anti-Evasion": "Anti-Evasión",
    "Group Exemptions": "Exenciones de Grupo",
    "Architecture Overview": "Descripción de la Arquitectura",
    "Testing Guide": "Guía de Pruebas",
    "Basic Enforcement": "Aplicación Básica",
    "Basic Settings": "Configuraciones Básicas",
    "Core enforcement policies for USB devices": "Políticas básicas de aplicación para dispositivos USB",
    "Only Enforce on USB Devices": "Solo Aplicar en Dispositivos USB",
    "When enabled, only USB devices are subject to enforcement. Other storage devices (SATA, NVMe) are not affected.": "Cuando está habilitado, solo los dispositivos USB están sujetos a la aplicación. Otros dispositivos de almacenamiento (SATA, NVMe) no se ven afectados.",
    "Allow LUKS1 (Read-Only)": "Permitir LUKS1 (Solo Lectura)",
    "Allow older LUKS1 encrypted devices in read-only mode. LUKS2 is recommended for better security.": "Permitir dispositivos cifrados LUKS1 antiguos en modo de solo lectura. Se recomienda LUKS2 para mayor seguridad.",
    "Allow Write with Content Scanning": "Permitir Escritura con Escaneo de Contenido",
    "Allow write access to unencrypted USB drives when content scanning is enabled. Files are scanned for sensitive data before writing.": "Permitir acceso de escritura a unidades USB sin cifrar cuando el escaneo de contenido está habilitado. Los archivos se escanean en busca de datos sensibles antes de escribir.",
    "Desktop Notifications": "Notificaciones de Escritorio",
    "Show desktop notifications when USB devices are connected or blocked.": "Mostrar notificaciones de escritorio cuando se conectan o bloquean dispositivos USB.",
    "Minimum Passphrase Length": "Longitud Mínima de Contraseña",
    "Minimum number of characters required for encryption passphrases. Recommended: 12 or higher.": "Número mínimo de caracteres requeridos para contraseñas de cifrado. Recomendado: 12 o más.",
    "Exempted Groups": "Grupos Exentos",
    "Linux groups that are exempt from USB enforcement. Users in these groups can use any USB devices without restrictions. Enter one group name per line.": "Grupos de Linux que están exentos de la aplicación USB. Los usuarios en estos grupos pueden usar cualquier dispositivo USB sin restricciones. Ingrese un nombre de grupo por línea.",
    "Basic": "Básico",
    "Security Settings": "Configuraciones de Seguridad",
    "Access Control": "Control de Acceso",
    "Secret token and socket security settings": "Configuraciones de seguridad de tokens secretos y sockets",
    "Token TTL (seconds)": "TTL de Token (segundos)",
    "Time-to-live for one-time tokens used in passphrase handoff. After this time, tokens expire and cannot be used.": "Tiempo de vida para tokens de un solo uso utilizados en la transferencia de contraseña. Después de este tiempo, los tokens expiran y no se pueden usar.",
    "Maximum Outstanding Tokens": "Tokens Máximos Pendientes",
    "Maximum number of tokens kept in memory at once. Prevents memory exhaustion from token spam.": "Número máximo de tokens mantenidos en memoria a la vez. Previene el agotamiento de memoria por spam de tokens.",
    "Mount Options": "Opciones de Montaje",
    "Security flags for mounting USB devices": "Banderas de seguridad para montar dispositivos USB",
    "Plaintext Mount Options": "Opciones de Montaje Sin Cifrar",
    "Mount options for unencrypted USB devices. Recommended: nodev, nosuid, noexec, ro": "Opciones de montaje para dispositivos USB sin cifrar. Recomendado: nodev, nosuid, noexec, ro",
    "Encrypted Mount Options": "Opciones de Montaje Cifrado",
    "Mount options for encrypted USB devices. Recommended: nodev, nosuid, rw": "Opciones de montaje para dispositivos USB cifrados. Recomendado: nodev, nosuid, rw",
    "Require No-Execute on Plaintext": "Requerir No-Ejecución en Texto Plano",
    "Prevent execution of binaries from unencrypted USB devices. Recommended for security.": "Prevenir la ejecución de binarios de dispositivos USB sin cifrar. Recomendado para seguridad.",
    "Security": "Seguridad",
    "Encryption Settings": "Configuraciones de Cifrado",
    "Encryption Defaults": "Valores Predeterminados de Cifrado",
    "Default settings for USB device encryption": "Configuraciones predeterminadas para cifrado de dispositivos USB",
    "Default Encryption Type": "Tipo de Cifrado Predeterminado",
    "luks2: Linux Unified Key Setup (Linux only)\\nveracrypt: VeraCrypt (Cross-platform: Windows/Mac/Linux)\\nNote: VeraCrypt must be installed separately": "luks2: Linux Unified Key Setup (solo Linux)\\nveracrypt: VeraCrypt (multiplataforma: Windows/Mac/Linux)\\nNota: VeraCrypt debe instalarse por separado",
    "Encryption Target": "Objetivo de Cifrado",
    "whole_disk: Encrypt entire disk\\npartition: Encrypt specific partition only": "whole_disk: Cifrar disco completo\\npartition: Cifrar solo partición específica",
    "Filesystem Type": "Tipo de Sistema de Archivos",
    "Filesystem to use after encryption:\\nexfat: Cross-platform (Windows/Mac/Linux)\\next4: Linux native, journaling\\nntfs: Windows-focused": "Sistema de archivos a usar después del cifrado:\\nexfat: Multiplataforma (Windows/Mac/Linux)\\next4: Nativo de Linux, con journaling\\nntfs: Enfocado en Windows",
    "Key Derivation": "Derivación de Clave",
    "KDF (Key Derivation Function) settings": "Configuraciones de KDF (Función de Derivación de Clave)",
    "KDF Algorithm": "Algoritmo KDF",
    "argon2id: Recommended, resistant to GPU attacks\\npbkdf2: Older, less secure": "argon2id: Recomendado, resistente a ataques de GPU\\npbkdf2: Más antiguo, menos seguro",
    "Cipher Settings": "Configuraciones de Cifrado",
    "Encryption algorithm configuration": "Configuración del algoritmo de cifrado",
    "Cipher Algorithm": "Algoritmo de Cifrado",
    "aes-xts-plain64: Recommended for disk encryption\\naes-cbc-essiv:sha256: Older algorithm": "aes-xts-plain64: Recomendado para cifrado de disco\\naes-cbc-essiv:sha256: Algoritmo más antiguo",
    "Key Size (bits)": "Tamaño de Clave (bits)",
    "512: Maximum security (recommended)\\n256: Standard security": "512: Seguridad máxima (recomendado)\\n256: Seguridad estándar",
    "Encryption": "Cifrado",
    "Content Scanning (DLP)": "Escaneo de Contenido (DLP)",
    "Data Loss Prevention through real-time content scanning": "Prevención de Pérdida de Datos mediante escaneo de contenido en tiempo real",
    "Enable Content Scanning": "Habilitar Escaneo de Contenido",
    "Enable real-time scanning of files for sensitive data. Prevents writing credit cards, SSNs, API keys, etc. to USB devices.": "Habilitar el escaneo en tiempo real de archivos para datos sensibles. Previene la escritura de tarjetas de crédito, SSN, claves API, etc. en dispositivos USB.",
    "Scan Encrypted Devices": "Escanear Dispositivos Cifrados",
    "When enabled, scanning applies to both encrypted and unencrypted devices. When disabled, scanning only applies to unencrypted devices.": "Cuando está habilitado, el escaneo se aplica a dispositivos cifrados y sin cifrar. Cuando está deshabilitado, el escaneo solo se aplica a dispositivos sin cifrar.",
    "Action on Detection": "Acción al Detectar",
    "block: Prevent writing files with sensitive data\\nwarn: Allow write but show warning\\nlog_only: Allow write and log to journal": "block: Prevenir la escritura de archivos con datos sensibles\\nwarn: Permitir escritura pero mostrar advertencia\\nlog_only: Permitir escritura y registrar en el diario",
    "Scan Categories": "Categorías de Escaneo",
    "Types of sensitive data to detect": "Tipos de datos sensibles a detectar",
    "Enabled Categories": "Categorías Habilitadas",
    "Financial (credit cards, bank accounts, SWIFT, IBAN)": "Financiero (tarjetas de crédito, cuentas bancarias, SWIFT, IBAN)",
    "Personal (SSN, passport, driver license, phone)": "Personal (SSN, pasaporte, licencia de conducir, teléfono)",
    "Authentication (API keys, passwords, tokens)": "Autenticación (claves API, contraseñas, tokens)",
    "Medical (medical records, insurance IDs)": "Médico (registros médicos, IDs de seguro)",
    "Performance Settings": "Configuraciones de Rendimiento",
    "Scanning performance and limits": "Rendimiento y límites de escaneo",
    "Max File Size (MB)": "Tamaño Máximo de Archivo (MB)",
    "Maximum file size to scan (0 = unlimited). Larger files may be skipped or sampled based on oversize_action.": "Tamaño máximo de archivo a escanear (0 = ilimitado). Los archivos más grandes pueden omitirse o muestrearse según oversize_action.",
    "Oversize File Action": "Acción de Archivo Sobredimensionado",
    "block: Block files exceeding max size\\nallow_unscanned: Allow without scanning": "block: Bloquear archivos que excedan el tamaño máximo\\nallow_unscanned: Permitir sin escanear",
    "Streaming Threshold (MB)": "Umbral de Transmisión (MB)",
    "Files larger than this are written to temp disk before scanning. 0 = always stream to disk.": "Los archivos más grandes que esto se escriben en disco temporal antes del escaneo. 0 = siempre transmitir a disco.",
    "Large File Scan Mode": "Modo de Escaneo de Archivos Grandes",
    "full: Scan entire file contents\\nsampled: Sample portions of large files": "full: Escanear todo el contenido del archivo\\nsampled: Muestrear porciones de archivos grandes",
    "Scan Timeout (seconds)": "Tiempo de Espera de Escaneo (segundos)",
    "Maximum time to spend scanning a single file.": "Tiempo máximo para escanear un solo archivo.",
    "Max Concurrent Scans": "Escaneos Concurrentes Máximos",
    "Number of parallel scanning threads.": "Número de hilos de escaneo paralelos.",
    "Advanced Scanning": "Escaneo Avanzado",
    "Archive Scanning": "Escaneo de Archivos",
    "Scanning files inside archives (ZIP, TAR, 7Z, RAR)": "Escaneo de archivos dentro de archivos comprimidos (ZIP, TAR, 7Z, RAR)",
    "Scan Archive Contents": "Escanear Contenido de Archivos",
    "Extract and scan files inside archive files. Prevents hiding sensitive data in compressed files.": "Extraer y escanear archivos dentro de archivos comprimidos. Previene ocultar datos sensibles en archivos comprimidos.",
    "Max Archive Depth": "Profundidad Máxima de Archivo",
    "Maximum nesting level for archives (e.g., ZIP inside ZIP). Prevents zip bomb attacks.": "Nivel máximo de anidamiento para archivos (por ejemplo, ZIP dentro de ZIP). Previene ataques de bomba zip.",
    "Document Scanning": "Escaneo de Documentos",
    "Scanning Office and PDF documents": "Escaneo de documentos de Office y PDF",
    "Scan Documents": "Escanear Documentos",
    "Extract and scan text from PDF, DOCX, XLSX, PPTX, ODT files.": "Extraer y escanear texto de archivos PDF, DOCX, XLSX, PPTX, ODT.",
    "Machine Learning": "Aprendizaje Automático",
    "Advanced pattern detection": "Detección avanzada de patrones",
    "N-gram Analysis": "Análisis de N-gramas",
    "Use machine learning for pattern detection in unstructured text. Helps detect obfuscated or formatted sensitive data.": "Usar aprendizaje automático para detección de patrones en texto no estructurado. Ayuda a detectar datos sensibles ofuscados o formateados.",
    "Caching": "Almacenamiento en Caché",
    "Scan result caching for performance": "Almacenamiento en caché de resultados de escaneo para rendimiento",
    "Enable Scan Cache": "Habilitar Caché de Escaneo",
    "Cache scan results based on file hash. Improves performance for repeated scans of same files.": "Almacenar en caché los resultados del escaneo basados en el hash del archivo. Mejora el rendimiento para escaneos repetidos de los mismos archivos.",
    "Cache Size (MB)": "Tamaño de Caché (MB)",
    "Maximum size of scan result cache.": "Tamaño máximo del caché de resultados de escaneo.",
    "Custom Patterns": "Patrones Personalizados",
    "Define enterprise-specific sensitive data patterns": "Definir patrones de datos sensibles específicos de la empresa",
    "Manage Custom Patterns": "Administrar Patrones Personalizados",
    "{} custom pattern(s) defined": "{} patrón(es) personalizado(s) definido(s)",
    "Advanced": "Avanzado",
    "usb-enforcerd restarted.": "usb-enforcerd reiniciado.",
    "systemctl not found; cannot restart service.": "systemctl no encontrado; no se puede reiniciar el servicio.",
    "Failed to restart usb-enforcerd: {}": "Error al reiniciar usb-enforcerd: {}",
    "Custom Content Patterns": "Patrones de Contenido Personalizados",
    "Add Pattern": "Agregar Patrón",
    "Name:": "Nombre:",
    "e.g., employee_id": "p. ej., id_empleado",
    "Description:": "Descripción:",
    "e.g., Company employee ID": "p. ej., ID de empleado de la empresa",
    "Category:": "Categoría:",
    "Regex:": "Regex:",
    "e.g., EMP-\\\\d{6}": "p. ej., EMP-\\\\d{6}",
    "Common Patterns ▾": "Patrones Comunes ▾",
    "Test Pattern:": "Probar Patrón:",
    "Enter sample text to test the pattern...": "Ingrese texto de muestra para probar el patrón...",
    "Test Pattern": "Probar Patrón",
    "Delete Pattern": "Eliminar Patrón",
    "<span foreground='green'>✓ Valid regex pattern</span>": "<span foreground='green'>✓ Patrón regex válido</span>",
    "<span foreground='red'>✗ Invalid: {}</span>": "<span foreground='red'>✗ Inválido: {}</span>",
    "<span foreground='orange'>Enter a regex pattern first</span>": "<span foreground='orange'>Ingrese primero un patrón regex</span>",
    "<span foreground='orange'>Enter sample text to test</span>": "<span foreground='orange'>Ingrese texto de muestra para probar</span>",
    "<span foreground='red'>Fix regex errors first</span>": "<span foreground='red'>Corrija primero los errores de regex</span>",
    " ... ({} total)": " ... ({} total)",
    "<span foreground='green'>✓ Found {} match(es): {}</span>": "<span foreground='green'>✓ Se encontraron {} coincidencia(s): {}</span>",
    "<span foreground='orange'>No matches found in test text</span>": "<span foreground='orange'>No se encontraron coincidencias en el texto de prueba</span>",
    "<span foreground='red'>Test error: {}</span>": "<span foreground='red'>Error de prueba: {}</span>",
    "Employee ID": "ID de Empleado",
    "Project Code": "Código de Proyecto",
    "Account Number": "Número de Cuenta",
    "Internal IP": "IP Interna",
    "Document ID": "ID de Documento",
    "Serial Number": "Número de Serie",
    "Phone (US)": "Teléfono (EE.UU.)",
    "Email Domain": "Dominio de Correo",
    "API Key Format": "Formato de Clave API",
    "UUID": "UUID",
    "Common Pattern Templates": "Plantillas de Patrones Comunes",
    "Pattern: {}": "Patrón: {}",
    "Example: {}": "Ejemplo: {}",
    "Configuration saved to {}": "Configuración guardada en {}",
    "Configuration saved. Restart usb-enforcerd to apply changes.": "Configuración guardada. Reinicie usb-enforcerd para aplicar los cambios.",
    "Failed to save configuration: {}": "Error al guardar la configuración: {}",
    "Error loading configuration: {}\\nUsing default configuration.": "Error al cargar la configuración: {}\\nUsando configuración predeterminada.",
    "Available Documentation": "Documentación Disponible",
    "File Type Support": "Soporte de Tipos de Archivo",
    "Notifications": "Notificaciones",
    "Main Documentation": "Documentación Principal",
    "Documentation file not found: {}": "Archivo de documentación no encontrado: {}",
    "Error loading documentation: {}": "Error al cargar la documentación: {}",
}

def update_po_file(po_file_path):
    """Update .po file with translations"""
    with open(po_file_path, 'r', encoding='utf-8') as f:
        content = f.read()
    
    # Update each translation
    for english, spanish in translations.items():
        # Escape special characters for regex
        escaped_english = re.escape(english)
        # Match msgid with empty msgstr
        pattern = f'(msgid "{escaped_english}"\\nmsgstr ")(")'
        replacement = f'\\1{spanish}\\2'
        content = re.sub(pattern, replacement, content)
    
    with open(po_file_path, 'w', encoding='utf-8') as f:
        f.write(content)
    
    print(f"Updated {po_file_path} with Spanish translations")

if __name__ == "__main__":
    po_file = "locale/es/LC_MESSAGES/usb-enforcer.po"
    update_po_file(po_file)
    print(f"✓ Spanish translations added to {po_file}")
    print("Run 'msgfmt locale/es/LC_MESSAGES/usb-enforcer.po -o locale/es/LC_MESSAGES/usb-enforcer.mo' to compile")
